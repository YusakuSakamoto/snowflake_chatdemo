# テーブル設計：[[design.ANKEN_MEISAI]]

## 概要
APP_PRODUCTION.ANKEN_MEISAI は、外部システムやファイル（主に CSV）から提供される  
案件明細データをそのまま受け入れるための取込（Raw / Landing）テーブルである。

本テーブルは、業務的に正規化された案件明細の正本を表すものではなく、  
後段で行われる整形・検証・正規化処理のための一次受け皿として位置づけられる。

Vault を正本とした設計思想においては、本テーブルは  
「正しいかどうかを判断する前の事実を保持する層」として扱う。

## 業務上の意味
- このテーブルが表す概念  
  取込元ファイルに含まれる案件明細行の集合。  
  1レコードは「取込元データの1行」を表す。
- 主な利用シーン  
  - CSV 等のデータ取込・再取込  
  - 後段テーブル（整形・分析用）の入力元  
  - 取込内容の監査・差分確認・再現

本テーブル自体を業務ロジックや分析の正本として直接利用することは想定しない。

## 設計上の位置づけ
APP_PRODUCTION.ANKEN_MEISAI は、以下のレイヤ構成の最下流（取込側）に位置する。

- 取込（Raw / Landing）  
  → APP_PRODUCTION.ANKEN_MEISAI 
- 整形（型変換・正規化・制約付与）
- 業務・分析用正本（参照・集計）

このレイヤ分離により、取込の安定性と業務データの信頼性を切り分けて管理する。

## 設計方針

### 取込安定性を最優先する
本テーブルでは、以下を重視する。

- 取込元データの形式揺れを理由にロードを失敗させない
- 欠損・重複・不正値を含んだ状態でも保持できる
- 後から「何が来ていたか」を再現できる

そのため、本テーブルはデータ品質を保証する責務を持たない。

### 制約を設けないという設計判断
APP_PRODUCTION.ANKEN_MEISAI では、以下を意図的に行わない。

- 主キーによる一意性制約
- 外部キー制約
- NOT NULL 制約
- 業務的な妥当性チェック

これらは設計漏れではなく、  
取込テーブルとしての役割を明確に分離した結果の設計判断である。

制約や業務ルールは、後段の整形・正本テーブルで初めて厳密に定義する。

### データ型・表現の考え方
- 日付・期間・コード類は、取込段階では文字列表現を許容する
- 数値やフラグについても、取込時点では形式統一を強制しない
- 型変換・フォーマット統一は後段処理の責務とする

本テーブルは「解釈」ではなく「保持」を優先する。

## 正規化・非正規化の扱い
本テーブルには、以下のような非正規化された属性が含まれることがある。

- 名称・略称・ラベル系の情報
- 参照マスタ由来の冗長な項目

これは、取込元データの構造を忠実に保存するためであり、  
正本マスタとの整合性を本テーブルで担保することはしない。

正規化・突合・更新ルールの定義は、後段テーブルで行う。

## 運用上の注意
- 本テーブルを直接参照する分析クエリや BI 接続は行わない
- 正式な参照先は、必ず後段の整形・業務用テーブルを使用する
- 再取込・再実行を前提とし、データは冪等に扱う

APP_PRODUCTION.ANKEN_MEISAI は、
「消してはいけないが、そのまま信用してはいけない層」として運用する。

## 関連
- 上位設計思想：[[design.DB_DESIGN]]
- スキーマ設計：[[design.APP_PRODUCTION]]
- 後段テーブル：案件明細（整形・正本）テーブル群（別途定義）

table_id:: TBL_20251225133349
```dataview
TABLE comment, physical
FROM "master/columns"
WHERE table_id = this.table_id
SORT schema_id, physical
```
