# テーブル設計：DEPARTMENT_MASTER

## 概要
APP_PRODUCTION.DEPARTMENT_MASTER は、外部システムや CSV ファイルから提供される  
**部署マスタ情報を年度単位で取り込むための取込（Raw / Landing）テーブル**である。

本テーブルは「部署マスタ」という名称を持つが、  
業務上の正本マスタや参照用マスタを直接表すものではなく、  
後段で整形・正規化された部署マスタを構築するための **一次受け皿**として位置づけられる。

## 業務上の意味
- このテーブルが表す概念  
  取込元ファイルに含まれる **年度別の部署定義行の集合**。  
  1レコードは、特定年度における1部署（または部署構成単位）を表す。
- 主な利用シーン  
  - 部署マスタ CSV の取込・再取込  
  - 年度差分の確認・比較  
  - 後段の正規化部署マスタ作成の入力元

本テーブルを業務処理や分析処理の参照正本として直接利用することは想定しない。

## 設計上の位置づけ
APP_PRODUCTION.DEPARTMENT_MASTER は、以下のレイヤ構成における取込層に属する。

- 取込（Raw / Landing）  
  → **APP_PRODUCTION.DEPARTMENT_MASTER**
- 整形（年度統合・正規化・型変換・制約付与）
- 業務・分析用部署マスタ（参照正本）

「年度別に与えられる部署定義」をそのまま保持し、  
年度を跨いだ一貫性や参照安定性は後段レイヤで担保する。

## 設計方針

### 年度別マスタとしての扱い
- 本テーブルは **年度（FISCAL_YEAR）を含む部署定義のスナップショット**を保持する。
- 年度ごとに以下が変化しうる前提を許容する：
  - 部署構成
  - コード体系
  - 名称・略称
  - 組織階層
- 異なる年度間での部署同一性判断は、本テーブルの責務外とする。

### 取込安定性を優先する設計
本テーブルでは、以下を重視する。

- 取込元データの形式揺れや欠損を理由にロードを失敗させない
- 年度途中の暫定データや不完全データも保持できる
- 後から「その年度に何が定義されていたか」を再現できる

そのため、本テーブルは **業務的な正しさや完全性を保証しない**。

### 制約を設けないという判断
APP_PRODUCTION.DEPARTMENT_MASTER では、以下を **意図的に行わない**。

- 主キーによる一意性制約
- 外部キー制約
- NOT NULL 制約
- 年度跨ぎの整合性チェック

これらは設計不足ではなく、  
**取込テーブルとしての役割を明確に分離した結果の設計判断**である。

後段の正本マスタでは、年度統合方針・識別子・参照制約を明確に定義する。

## 部署構成情報の扱い
本テーブルには、以下のような部署構成・階層に関する情報が含まれる。

- 本部 / 統括部 / 部 / 課 / グループ等のコード・名称
- 組合せ名称・略称など、取込元独自の表現

これらは **取込元が定義する粒度・構造をそのまま保持する**ことを目的とする。  
組織階層モデルの正規化や再構成は、本テーブルでは行わない。

## データ型・表現の考え方
- コード類・名称類は、取込段階では文字列表現を前提とする
- 数値・年度情報についても、形式統一は後段処理に委ねる
- 本テーブルは「解釈」や「意味付け」よりも「保存」を優先する

## 運用上の注意
- 本テーブルを直接参照する業務処理・分析クエリは行わない
- 正式な参照先は、必ず後段の整形・正本部署マスタを使用する
- 年度別に再取込が発生する前提で、冪等な運用を行う

APP_PRODUCTION.DEPARTMENT_MASTER は  
「**部署マスタという名前を持つが、まだ正本ではない層**」として扱う。

## 関連
- 上位設計思想：[[design.DB_DESIGN]]
- スキーマ設計：[[design.APP_PRODUCTION]]
- 後段テーブル：部署マスタ（整形・正本）テーブル群（別途定義）


table_id:: TBL_20251225144134
```dataview
TABLE comment, physical
FROM "master/columns"
WHERE table_id = this.table_id
SORT schema_id, physical
```
