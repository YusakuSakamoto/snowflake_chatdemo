{"metrics":[{"as_of_at":"2025-12-30 05:06:03.547 -0800","column":"RUN_ID","metrics":{"distinct_count":7,"distinct_rate_non_null":3.684210526315789e-01,"max_len":40,"max_varchar":"RUN-cd73d4e4-7c5e-4881-a515-9b154529f70f","min_len":40,"min_varchar":"RUN-36f25729-6ee7-4d49-9069-04168d952b04","null_count":0,"null_rate":0.000000000000000e+00,"row_count":19,"top_values":[{"count":5,"value":"RUN-55b546de-3520-4b5c-a818-501222274870"},{"count":4,"value":"RUN-cd73d4e4-7c5e-4881-a515-9b154529f70f"},{"count":3,"value":"RUN-82d700bd-89e2-47c3-8d5a-81bdcf23ac9b"},{"count":3,"value":"RUN-97e3b64e-c8e7-4bfe-94d9-5a04f71b341a"},{"count":2,"value":"RUN-7801d184-c165-4a28-9959-4251973882fa"},{"count":1,"value":"RUN-36f25729-6ee7-4d49-9069-04168d952b04"},{"count":1,"value":"RUN-c50e4304-81dc-4b13-95d2-780ce6e5bd51"}]},"run_id":"RUN-021612e8-9e32-41f8-af96-40191ccb8d48"},{"as_of_at":"2025-12-30 05:06:04.852 -0800","column":"TARGET_COLUMN","metrics":{"distinct_count":17,"distinct_rate_non_null":8.947368421052632e-01,"max_len":29,"max_varchar":"TARGET_DB","min_len":6,"min_varchar":"COMBINED_SHORT_NAME","null_count":0,"null_rate":0.000000000000000e+00,"row_count":19,"top_values":[{"count":2,"value":"FISCAL_YEAR"},{"count":2,"value":"CUSTOMER_ORDER_NUMBER"},{"count":1,"value":"SALES_DELIVERY_FLAG"},{"count":1,"value":"DIVISION_CODE"},{"count":1,"value":"CUSTOMER_NAME"},{"count":1,"value":"RUN_ID"},{"count":1,"value":"TARGET_DB"},{"count":1,"value":"COMBINED_SHORT_NAME"},{"count":1,"value":"DEPARTMENT_ID"},{"count":1,"value":"OBJECT_ID"},{"count":1,"value":"INGESTED_AT"},{"count":1,"value":"DOC_ID"},{"count":1,"value":"CUSTOMER_ID"},{"count":1,"value":"DEPARTMENT_NAME"},{"count":1,"value":"SECTION_NAME"},{"count":1,"value":"GROUP_SHORT_NAME"},{"count":1,"value":"DEPARTMENT_SECTION_SHORT_NAME"}]},"run_id":"RUN-021612e8-9e32-41f8-af96-40191ccb8d48"},{"as_of_at":"2025-12-30 05:06:06.105 -0800","column":"AS_OF_AT","metrics":{"distinct_count":13,"distinct_rate_non_null":1.000000000000000e+00,"max_len":29,"max_varchar":"2025-12-30 05:06:04.852 -0800","min_len":29,"min_varchar":"2025-12-30 01:40:05.734 -0800","null_count":0,"null_rate":0.000000000000000e+00,"row_count":13,"top_values":[{"count":1,"value":"2025-12-30 05:05:14.575 -0800"},{"count":1,"value":"2025-12-30 05:05:16.055 -0800"},{"count":1,"value":"2025-12-30 05:05:46.474 -0800"},{"count":1,"value":"2025-12-30 01:41:05.242 -0800"},{"count":1,"value":"2025-12-30 05:05:37.626 -0800"},{"count":1,"value":"2025-12-30 05:05:20.985 -0800"},{"count":1,"value":"2025-12-30 01:40:16.213 -0800"},{"count":1,"value":"2025-12-30 05:06:04.852 -0800"},{"count":1,"value":"2025-12-30 01:40:05.734 -0800"},{"count":1,"value":"2025-12-30 01:41:07.105 -0800"},{"count":1,"value":"2025-12-30 01:40:26.257 -0800"},{"count":1,"value":"2025-12-30 05:05:38.523 -0800"},{"count":1,"value":"2025-12-30 01:40:46.997 -0800"}]},"run_id":"RUN-021612e8-9e32-41f8-af96-40191ccb8d48"},{"as_of_at":"2025-12-30 05:06:07.376 -0800","column":"METRICS","metrics":{"distinct_count":8,"distinct_rate_non_null":1.000000000000000e+00,"max_len":27249,"max_varchar":"{\\"distinct_count\\":97,\\"distinct_rate_non_null\\":7.637795275590551e-01,\\"max_len\\":48,\\"max_varchar\\":\\"Ｓｏｌａｒｉｓ関連システム障害対応迅速化のための業務支援\\",\\"min_len\\":2,\\"min_varchar\\":\\"2025_統括部）協力会社育成(5月)\\",\\"null_count\\":0,\\"null_rate\\":0.000000000000000e+00,\\"row_count\\":127,\\"top_values\\":[{\\"count\\":6,\\"value\\":\\"Microsoft Azure クラウド利用料\\"},{\\"count\\":4,\\"value\\":\\"技術料\\"},{\\"count\\":3,\\"value\\":\\"FL.OPS利用料金\\"},{\\"count\\":3,\\"value\\":\\"クラウド利用料(AWS)\\"},{\\"count\\":3,\\"value\\":\\"情報処理システム開発(令4条1項1号)坂本分\\"},{\\"count\\":3,\\"value\\":\\"ニフクラ利用料金\\"},{\\"count\\":3,\\"value\\":\\"インフラ設計／構築／保守業務\\"},{\\"count\\":3,\\"value\\":\\"ニフクラウド利用料(正晃) SPDシステム\\"},{\\"count\\":3,\\"value\\":\\"インフラサポート（月額）\\"},{\\"count\\":2,\\"value\\":\\"Ｓｏｌａｒｉｓ関連システム障害対応迅速化のための業務支援\\"},{\\"count\\":2,\\"value\\":\\"人労シェアードシステム（問合せ対応）\\"},{\\"count\\":2,\\"value\\":\\"ハード制御仕様書の管理Tool開発（中村）（202510-202603）\\"},{\\"count\\":2,\\"value\\":\\"BiCS保守\\"},{\\"count\\":2,\\"value\\":\\"AWS案件(JTP様SES契約) ※ガバメントクラウド案件　石橋(BP)\\"},{\\"count\\":2,\\"value\\":\\"届出管理システム保守\\"},{\\"count\\":2,\\"value\\":\\"ストレスチェックシステム保守\\"},{\\"count\\":2,\\"value\\":\\"サーバ運用保守\\"},{\\"count\\":1,\\"value\\":\\"Honda社Tagetik導入案件（202601-03）\\"},{\\"count\\":1,\\"value\\":\\"中継設備管理システム保守\\"},{\\"count\\":1,\\"value\\":\\"【脱ホ配】配資経システム再構築のうち事前疎結合対応について（ＳＴＥＰ１）\\"}]}","min_len":321,"min_varchar":"{\\"distinct_count\\":12,\\"distinct_rate_non_null\\":1.000000000000000e+00,\\"max_len\\":5,\\"max_varchar\\":\\"00110\\",\\"min_len\\":5,\\"min_varchar\\":\\"00007\\",\\"null_count\\":0,\\"null_rate\\":0.000000000000000e+00,\\"row_count\\":12,\\"top_values\\":[{\\"count\\":1,\\"value\\":\\"00071\\"},{\\"count\\":1,\\"value\\":\\"00007\\"},{\\"count\\":1,\\"value\\":\\"00052\\"},{\\"count\\":1,\\"value\\":\\"00053\\"},{\\"count\\":1,\\"value\\":\\"00014\\"},{\\"count\\":1,\\"value\\":\\"00055\\"},{\\"count\\":1,\\"value\\":\\"00095\\"},{\\"count\\":1,\\"value\\":\\"00102\\"},{\\"count\\":1,\\"value\\":\\"00031\\"},{\\"count\\":1,\\"value\\":\\"00036\\"},{\\"count\\":1,\\"value\\":\\"00110\\"},{\\"count\\":1,\\"value\\":\\"00072\\"}]}","null_count":0,"null_rate":0.000000000000000e+00,"row_count":8,"top_values":[{"count":1,"value":"{\\"distinct_count\\":4,\\"distinct_rate_non_null\\":3.252032520325204e-02,\\"max_len\\":4,\\"max_varchar\\":\\"派遣\\",\\"min_len\\":2,\\"min_varchar\\":\\"サービス\\",\\"null_count\\":0,\\"null_rate\\":0.000000000000000e+00,\\"row_count\\":123,\\"top_values\\":[{\\"count\\":55,\\"value\\":\\"作成請負\\"},{\\"count\\":32,\\"value\\":\\"作業請負\\"},{\\"count\\":25,\\"value\\":\\"サービス\\"},{\\"count\\":11,\\"value\\":\\"派遣\\"}]}"},{"count":1,"value":"{\\"distinct_count\\":27,\\"distinct_rate_non_null\\":1.901408450704225e-01,\\"max_len\\":5,\\"max_varchar\\":\\"22328\\",\\"min_len\\":5,\\"min_varchar\\":\\"21111\\",\\"null_count\\":0,\\"null_rate\\":0.000000000000000e+00,\\"row_count\\":142,\\"top_values\\":[{\\"count\\":22,\\"value\\":\\"21224\\"},{\\"count\\":22,\\"value\\":\\"21112\\"},{\\"count\\":14,\\"value\\":\\"21222\\"},{\\"count\\":11,\\"value\\":\\"21221\\"},{\\"count\\":8,\\"value\\":\\"22111\\"},{\\"count\\":6,\\"value\\":\\"21111\\"},{\\"count\\":6,\\"value\\":\\"22317\\"},{\\"count\\":6,\\"value\\":\\"21121\\"},{\\"count\\":6,\\"value\\":\\"22121\\"},{\\"count\\":6,\\"value\\":\\"22318\\"},{\\"count\\":4,\\"value\\":\\"21131\\"},{\\"count\\":4,\\"value\\":\\"21212\\"},{\\"count\\":4,\\"value\\":\\"22122\\"},{\\"count\\":3,\\"value\\":\\"21213\\"},{\\"count\\":2,\\"value\\":\\"22312\\"},{\\"count\\":2,\\"value\\":\\"21132\\"},{\\"count\\":2,\\"value\\":\\"22326\\"},{\\"count\\":2,\\"value\\":\\"22221\\"},{\\"count\\":2,\\"value\\":\\"21123\\"},{\\"count\\":2,\\"value\\":\\"21211\\"}]}"},{"count":1,"value":"{\\"distinct_count\\":14,\\"distinct_rate_non_null\\":1.000000000000000e+00,\\"max_len\\":6752,\\"max_varchar\\":\\"<%*\\\\n/**\\\\n * Schema template (Snowflake)\\\\n * - schema_id: SCH_YYYYMMDDHHmmss\\\\n * - filename: <physical>.md\\\\n * - moves file to master/schemas/\\\\n */\\\\nconst folder = \\\\\\"master/schemas\\\\\\";\\\\n\\\\nfunction safeFileName(name){\\\\n  return String(name ?? \\\\\\"SCHEMA\\\\\\")\\\\n    .trim()\\\\n    .replaceAll(\\\\\\"/\\\\\\", \\\\\\"_\\\\\\")\\\\n    .replaceAll(\\\\\\"\\\\\\\\\\\\\\\\\\\\\\", \\\\\\"_\\\\\\")\\\\n    .replaceAll(\\\\\\":\\\\\\", \\\\\\"_\\\\\\");\\\\n}\\\\n\\\\nconst schemaId = \\\\\\"SCH_\\\\\\" + tp.date.now(\\\\\\"YYYYMMDDHHmmss\\\\\\");\\\\nconst physicalRaw = await tp.system.prompt(\\\\\\"物理名（例: PUBLIC）\\\\\\");\\\\nconst physical = safeFileName(physicalRaw);\\\\nconst comment  = await tp.system.prompt(\\\\\\"comment（任意）\\\\\\") ?? \\\\\\"\\\\\\";\\\\n\\\\n// 配置先＋ファイル名を physical にする\\\\nawait tp.file.move(`${folder}/${physical}`);\\\\n-%>\\\\n---\\\\ntype: schema\\\\nschema_id: <%- schemaId %>\\\\nphysical: <%- physicalRaw %>\\\\ncomment: <%- comment %>\\\\n---\\\\n\\\\n# <%- physicalRaw %>\\\\n\\",\\"min_len\\":88,\\"min_varchar\\":\\"\\\\n\\\\n```dataview\\\\nTABLE comment, physical\\\\nFROM \\\\\\"master/tables\\\\\\"\\\\nSORT schema_id, physical\\\\n```\\\\n\\",\\"null_count\\":0,\\"null_rate\\":0.000000000000000e+00,\\"row_count\\":14,\\"top_values\\":[{\\"count\\":1,\\"value\\":\\"---\\\\ntype: column\\\\ncolumn_id: COL_20251227125402\\\\ntable_id: TBL_20251227124901\\\\nphysical: OBJECT_ID\\\\ndomain: VARCHAR\\\\npk: false\\\\nis_nullable: true\\\\ndefault:\\\\ncomment: 設計オブジェクトに紐づく論理 ID（schema_id / table_id / column_id / view_id 等）。frontmatter 由来。\\\\n---\\\\n\\\\n# OBJECT_ID\\\\n\\"},{\\"count\\":1,\\"value\\":\\"<%*\\\\n/**\\\\n * Schema template (Snowflake)\\\\n * - schema_id: SCH_YYYYMMDDHHmmss\\\\n * - filename: <physical>.md\\\\n * - moves file to master/schemas/\\\\n */\\\\nconst folder = \\\\\\"master/schemas\\\\\\";\\\\n\\\\nfunction safeFileName(name){\\\\n  return String(name ?? \\\\\\"SCHEMA\\\\\\")\\\\n    .trim()\\\\n    .replaceAll(\\\\\\"/\\\\\\", \\\\\\"_\\\\\\")\\\\n    .replaceAll(\\\\\\"\\\\\\\\\\\\\\\\\\\\\\", \\\\\\"_\\\\\\")\\\\n    .replaceAll(\\\\\\":\\\\\\", \\\\\\"_\\\\\\");\\\\n}\\\\n\\\\nconst schemaId = \\\\\\"SCH_\\\\\\" + tp.date.now(\\\\\\"YYYYMMDDHHmmss\\\\\\");\\\\nconst physicalRaw = await tp.system.prompt(\\\\\\"物理名（例: PUBLIC）\\\\\\");\\\\nconst physical = safeFileName(physicalRaw);\\\\nconst comment  = await tp.system.prompt(\\\\\\"comment（任意）\\\\\\") ?? \\\\\\"\\\\\\";\\\\n\\\\n// 配置先＋ファイル名を physical にする\\\\nawait tp.file.move(`${folder}/${physical}`);\\\\n-%>\\\\n---\\\\ntype: schema\\\\nschema_id: <%- schemaId %>\\\\nphysical: <%- physicalRaw %>\\\\ncomment: <%- comment %>\\\\n---\\\\n\\\\n# <%- physicalRaw %>\\\\n\\"},{\\"count\\":1,\\"value\\":\\"---\\\\ntype: column\\\\ncolumn_id: COL_20251229021259\\\\ntable_id: TBL_20251229020952\\\\nphysical: ENTITY_NAME\\\\ndomain: VARCHAR\\\\npk: false\\\\nis_nullable: false\\\\ndefault:\\\\ncomment: 正式名称（UI表示・確認用）\\\\n---\\\\n\\\\n# ENTITY_NAME\\\\n\\"},{\\"count\\":1,\\"value\\":\\"---\\\\ntype: column\\\\ncolumn_id: COL_20251229021602\\\\ntable_id: TBL_20251229020952\\\\nphysical: CREATED_AT\\\\ndomain: TIMESTAMP_NTZ\\\\npk: false\\\\nis_nullable: false\\\\ndefault: CURRENT_TIMESTAMP()\\\\ncomment:\\\\n---\\\\n\\\\n# CREATED_AT\\\\n\\"},{\\"count\\":1,\\"value\\":\\"\\\\n\\\\n```dataview\\\\nTABLE comment, physical\\\\nFROM \\\\\\"master/tables\\\\\\"\\\\nSORT schema_id, physical\\\\n```\\\\n\\"},{\\"count\\":1,\\"value\\":\\"---\\\\ntype: column\\\\ncolumn_id: COL_20251225144212\\\\ntable_id: TBL_20251225144134\\\\nphysical: ID\\\\ndomain: VARCHAR\\\\npk: false\\\\nis_nullable: true\\\\ndefault: \\\\ncomment: レコードID\\\\n---\\\\n\\\\n# ID\\\\n\\"},{\\"count\\":1,\\"value\\":\\"---\\\\ntype: column\\\\ncolumn_id: COL_20251226182047\\\\ntable_id: TBL_20251226180943\\\\nphysical: NOTE\\\\ndomain: VARCHAR\\\\npk: false\\\\nis_nullable: true\\\\ndefault:\\\\ncomment: 実行に関する補足情報やユーザメモ。異常終了時にはエラーコードおよびエラーメッセージが追記されることがある。\\\\n---\\\\n\\\\n# NOTE\\\\n\\"},{\\"count\\":1,\\"value\\":\\"# ビュー設計：V_INVOICE\\\\n\\\\n## 概要\\\\nAPP_PRODUCTION.V_INVOICE は、取込テーブル（案件明細）から **請求（invoice）を分析・参照しやすい単位に整形**して提供する VIEW である。\\\\n\\\\n取込側では請求番号が欠損している行や、同一請求が複数明細に分割されているケースがあり得る。  \\\\n本 VIEW はその前提を受け入れた上で、以下を実現する。\\\\n\\\\n- 請求の粒度を「請求×計上月」に固定する\\\\n- 請求番号が無い場合でも、請求を表すキーを作って集計可能にする\\\\n- 金額を請求単位で集計し、参照・分析の入口を提供する\\\\n\\\\n## 位置づけ（レイヤ）\\\\n- 入力：取込（Raw / Landing）層の案件明細テーブル（ANKEN_MEISAI）\\\\n- 出力：提供（Views / Normalized）層の請求 VIEW\\\\n- 下流利用：\\\\n  - セマンティックモデル（YAML）の INVOICES テーブル相当\\\\n  - オーダ（V_ORDER_MASTER）との JOIN 起点\\\\n  - 月次売上（請求金額）集計のベース\\\\n\\\\n本 VIEW は請求の正本テーブルではなく、デモ用途の「正規化提供層」として機能する。\\\\n\\\\n## 粒度（Grain）\\\\n本 VIEW の 1レコードは、以下の単位を表す。\\\\n\\\\n- 請求キー（invoice_key）\\\\n- 計上月（accounting_month）\\\\n\\\\n請求番号が存在する場合は請求番号が実質的な識別子になる。  \\\\n一方で、請求番号が欠損しているケースを許容するため、本 VIEW では「請求キー」を導入して粒度を安定させる。\\\\n\\\\n## 請求キー（invoice_key）の設計意図\\\\n取込データには、請求番号（invoice_number）が欠損している明細が存在しうる。  \\\\nその場合でも「請求という概念」を分析上扱えるよう、本 VIEW では請求キーを定義する。\\\\n\\\\n- 請求番号がある場合：請求番号をキーとして採用する\\\\n- 請求番号がない場合：オーダ番号を用いて仮キーを生成する  \\\\n  （例：NO_INVOICE_<order_number>）\\\\n\\\\nこの設計により、\\\\n- 請求番号が無い明細を WHERE 句で除外せずに済む\\\\n- 売上集計（請求金額）の欠落を避けられる\\\\n- 「請求番号の欠損」をデータ品質問題として可視化しつつ、分析は継続できる\\\\n\\\\n※ 仮キーは「請求の正本識別子」ではなく、「集計・参照のための暫定キー」である。\\\\n\\\\n## 集計の考え方（SUM / MAX / ANY_VALUE）\\\\n取込側では同一請求（キー）・同一計上月に複数明細が存在しうるため、本 VIEW は請求単位に集約する。\\\\n\\\\n- 金額は請求の合計値として SUM する（請求金額の集計済値を提供する）\\\\n- 売上渡しフラグ等の状態は、同一請求内で矛盾していても VIEW を破綻させないために集約する  \\\\n  （例：MAX による代表状態の選択）\\\\n- オーダ番号など請求に紐づく参照キーは、同一請求内で基本的に一致する前提で代表値として選択し得る\\\\n\\\\n本 VIEW はデータ品質の矛盾を解決する層ではなく、\\\\n「分析で扱える最小限の形にまとめる層」である。\\\\n\\\\n## フィルタ方針（重要）\\\\n本 VIEW は、請求番号が無い行を **除外しない**。  \\\\n請求番号欠損を理由にデータを落とすと、売上集計が欠落するためである。\\\\n\\\\nしたがって、\\\\n- 請求番号が無い明細は仮キー側に集約される\\\\n- 欠損の存在は結果（invoice_key の形）で可視化される\\\\n\\\\n## 計上月（accounting_month）の意味\\\\n本 VIEW の粒度は「請求×計上月」であり、計上月は請求集計の基準となる。\\\\n\\\\n- 取込層では計上月が文字列表現であることを許容する\\\\n- セマンティックモデル側では、計上月を DATE（当月1日）に変換して時系列分析に利用することがある  \\\\n  （VIEW 自体は「保持」と「集約」を主目的とする）\\\\n\\\\n## データ品質に関する前提\\\\n本 VIEW は、取込層のデータ品質を完全に保証するものではない。  \\\\nただし、参照・分析で最低限破綻しないよう、以下を前提とする。\\\\n\\\\n- 請求番号欠損は許容し、仮キーで集約する\\\\n- 同一請求内で属性が揺れている場合、集約結果が採用される（揺れは別途検知対象）\\\\n- 計上月が欠損または不正な場合、請求単位の集計結果に影響しうる（監査対象）\\\\n\\\\n## 運用上の注意\\\\n- 本 VIEW は売上（請求金額）集計の入口として利用し、取込テーブルを直接参照する運用を避ける\\\\n- 仮キー（NO_INVOICE_*）が発生する割合は、データ品質の重要指標になり得る\\\\n- 将来的に請求正本テーブルや請求番号管理が導入される場合、本 VIEW の仮キー設計は見直し対象となる\\\\n\\\\n## 関連\\\\n- スキーマ設計：[[design.APP_PRODUCTION]]\\\\n- 取込テーブル設計：[[design.ANKEN_MEISAI]]\\\\n- 関連 VIEW：[[design.V_ORDER_MASTER]] / [[design.V_PROJECT_MASTER]] / [[design.V_CUSTOMER_MASTER]]\\\\n- セマンティックモデル（INVOICES）：YAML 側の INVOICES 定義（別途管理）\\\\n\\\\n---\\\\n\\"},{\\"count\\":1,\\"value\\":\\"---\\\\ntype: view\\\\nview_id: VW_20251227014013\\\\nschema_id: SCH_20251226180633\\\\nphysical: DOCS_OBSIDIAN_V\\\\ncomment: Obsidian VaultのMarkdownを解析し、Cortex Search/Agent用の検索メタ情報を付与したVIEW\\\\n---\\\\n\\\\n# DOCS_OBSIDIAN_V\\\\n\\\\n## View Columns\\\\n> ここは VIEW の括弧内定義（列名＋列コメント）を書く（型は不要）\\\\n\\\\n| column_name   | comment                                                   |\\\\n| ------------- | --------------------------------------------------------- |\\\\n| DOC_ID        | Obsidianノートの一意ID（1ファイル=1レコード）                             |\\\\n| PATH          | Vault内のMarkdownファイルパス（.md付き）                              |\\\\n| FOLDER        | Vault内のフォルダパス（PATHの上位）                                    |\\\\n| CONTENT       | Markdown本文（全文）                                            |\\\\n| UPDATED_AT    | Snowflakeに取り込まれた時刻（最新判定用）                                 |\\\\n| SCOPE         | Vault上の大分類（master / design / views / templates / other）   |\\\\n| FILE_TYPE     | ノート種別（master_columns / profile_evidence / agent_review 等） |\\\\n| RUN_DATE      | EvidenceやReviewの対象日（YYYY-MM-DD）。パスまたはfrontmatterから抽出      |\\\\n| TARGET_SCHEMA | 対象スキーマ名（PATH規約から抽出）                                       |\\\\n| TARGET_TABLE  | 対象テーブル名（PATH規約から抽出）                                       |\\\\n| TARGET_COLUMN | 対象カラム名（master/columns のみ）                                 |\\\\n\\\\n## SQL\\\\n```sql\\\\nWITH base AS (\\\\n  SELECT\\\\n    DOC_ID,\\\\n    PATH,\\\\n    FOLDER,\\\\n    CONTENT,\\\\n    INGESTED_AT AS UPDATED_AT\\\\n  FROM DB_DESIGN.DOCS_OBSIDIAN\\\\n),\\\\nparsed AS (\\\\n  SELECT\\\\n    DOC_ID,\\\\n    PATH,\\\\n    FOLDER,\\\\n    CONTENT,\\\\n    UPDATED_AT,\\\\n\\\\n    /* 大分類 */\\\\n    CASE\\\\n      WHEN PATH LIKE 'master/%'     THEN 'master'\\\\n      WHEN PATH LIKE 'design/%'     THEN 'design'\\\\n      WHEN PATH LIKE 'views/%'      THEN 'views'\\\\n      WHEN PATH LIKE 'templates/%'  THEN 'templates'\\\\n      ELSE 'other'\\\\n    END AS SCOPE,\\\\n\\\\n    /* 詳細種別（検索・Agent制御用） */\\\\n    CASE\\\\n      WHEN PATH LIKE 'master/columns/%' THEN 'master_columns'\\\\n      WHEN PATH LIKE 'master/tables/%'  THEN 'master_tables'\\\\n      WHEN PATH LIKE 'master/schemas/%' THEN 'master_schemas'\\\\n      WHEN PATH LIKE 'master/views/%'   THEN 'master_views'\\\\n      WHEN PATH LIKE 'master/other/%'   THEN 'master_other'\\\\n      WHEN PATH LIKE 'design/reviews/profiles/%' THEN 'profile_evidence'\\\\n      WHEN PATH LIKE 'design/reviews/agent/%'    THEN 'agent_review'\\\\n      ELSE 'misc'\\\\n    END AS FILE_TYPE,\\\\n\\\\n    /* RUN_DATE：パス優先 → frontmatter fallback */\\\\n    COALESCE(\\\\n      /* profiles */\\\\n      IFF(PATH LIKE 'design/reviews/profiles/%',\\\\n          REGEXP_SUBSTR(\\\\n            PATH,\\\\n            'design/reviews/profiles/([0-9]{4}-[0-9]{2}-[0-9]{2})/',\\\\n            1, 1, 'e', 1\\\\n          ),\\\\n          NULL\\\\n      ),\\\\n\\\\n      /* agent */\\\\n      IFF(PATH LIKE 'design/reviews/agent/%',\\\\n          REGEXP_SUBSTR(\\\\n            PATH,\\\\n            'design/reviews/agent/([0-9]{4}-[0-9]{2}-[0-9]{2})/',\\\\n            1, 1, 'e', 1\\\\n          ),\\\\n          NULL\\\\n      ),\\\\n\\\\n      /* frontmatter: review_date */\\\\n      REGEXP_SUBSTR(\\\\n        CONTENT,\\\\n        '^review_date:\\\\\\\\\\\\\\\\s*([0-9]{4}-[0-9]{2}-[0-9]{2})\\\\\\\\\\\\\\\\s*$',\\\\n        1, 1, 'me', 1\\\\n      ),\\\\n\\\\n      /* frontmatter: generated_on */\\\\n      REGEXP_SUBSTR(\\\\n        CONTENT,\\\\n        '^generated_on:\\\\\\\\\\\\\\\\s*([0-9]{4}-[0-9]{2}-[0-9]{2})\\\\\\\\\\\\\\\\s*$',\\\\n        1, 1, 'me', 1\\\\n      )\\\\n    ) AS RUN_DATE,\\\\n\\\\n    /* TARGET_SCHEMA */\\\\n    IFF(PATH LIKE 'master/columns/%',\\\\n        REGEXP_SUBSTR(\\\\n          PATH,\\\\n          'master/columns/([^.]+)\\\\\\\\\\\\\\\\.',\\\\n          1, 1, 'e', 1\\\\n        ),\\\\n        COALESCE(\\\\n          IFF(PATH LIKE 'design/reviews/profiles/%',\\\\n              REGEXP_SUBSTR(\\\\n                PATH,\\\\n                'design/reviews/profiles/[0-9-]+/([^/]+)/',\\\\n                1, 1, 'e', 1\\\\n              ),\\\\n              NULL\\\\n          ),\\\\n          IFF(PATH LIKE 'design/reviews/agent/%',\\\\n              REGEXP_SUBSTR(\\\\n                PATH,\\\\n                'design/reviews/agent/[0-9-]+/([^/]+)/',\\\\n                1, 1, 'e', 1\\\\n              ),\\\\n              NULL\\\\n          )\\\\n        )\\\\n    ) AS TARGET_SCHEMA,\\\\n\\\\n    /* TARGET_TABLE */\\\\n    IFF(PATH LIKE 'master/columns/%',\\\\n        REGEXP_SUBSTR(\\\\n          PATH,\\\\n          'master/columns/[^.]+\\\\\\\\\\\\\\\\.([^.]+)\\\\\\\\\\\\\\\\.',\\\\n          1, 1, 'e', 1\\\\n        ),\\\\n        COALESCE(\\\\n          IFF(PATH LIKE 'design/reviews/profiles/%',\\\\n              REGEXP_SUBSTR(\\\\n                PATH,\\\\n                'design/reviews/profiles/[0-9-]+/[^/]+/([^/]+)\\\\\\\\\\\\\\\\.md$',\\\\n                1, 1, 'e', 1\\\\n              ),\\\\n              NULL\\\\n          ),\\\\n          IFF(PATH LIKE 'design/reviews/agent/%',\\\\n              REGEXP_SUBSTR(\\\\n                PATH,\\\\n                'design/reviews/agent/[0-9-]+/[^/]+/([^/]+)\\\\\\\\\\\\\\\\.review\\\\\\\\\\\\\\\\.md$',\\\\n                1, 1, 'e', 1\\\\n              ),\\\\n              NULL\\\\n          )\\\\n        )\\\\n    ) AS TARGET_TABLE,\\\\n\\\\n    /* TARGET_COLUMN（master/columns のみ） */\\\\n    IFF(PATH LIKE 'master/columns/%',\\\\n        REGEXP_SUBSTR(\\\\n          PATH,\\\\n          'master/columns/[^.]+\\\\\\\\\\\\\\\\.[^.]+\\\\\\\\\\\\\\\\.([^.]+)\\\\\\\\\\\\\\\\.md$',\\\\n          1, 1, 'e', 1\\\\n        ),\\\\n        NULL\\\\n    ) AS TARGET_COLUMN\\\\n\\\\n  FROM base\\\\n)\\\\nSELECT\\\\n  DOC_ID,\\\\n  PATH,\\\\n  FOLDER,\\\\n  CONTENT,\\\\n  UPDATED_AT,\\\\n  SCOPE,\\\\n  FILE_TYPE,\\\\n  RUN_DATE,\\\\n  TARGET_SCHEMA,\\\\n  TARGET_TABLE,\\\\n  TARGET_COLUMN\\\\nFROM parsed\\\\n```\\\\n\\"},{\\"count\\":1,\\"value\\":\\"\\\\n\\\\n```dataview\\\\nTABLE comment, physical, domain\\\\nFROM \\\\\\"master/columns\\\\\\"\\\\nSORT table_id, pk desc\\\\n```\\\\n\\\\n\\"},{\\"count\\":1,\\"value\\":\\"---\\\\ntype: column\\\\ncolumn_id: COL_20251226181139\\\\ntable_id: TBL_20251226180943\\\\nphysical: RUN_ID\\\\ndomain: VARCHAR\\\\npk: true\\\\nis_nullable: false\\\\ndefault:\\\\ncomment: プロファイル実行（run）を一意に識別するID。1回の PROFILE_TABLE 実行につき1つ発行される。原則としてUUID等によりアプリケーション側で一意生成され、同一RUN_IDでの再実行時は結果を上書きする。\\\\n---\\\\n\\\\n# RUN_ID\\\\n\\"},{\\"count\\":1,\\"value\\":\\"---\\\\ntype: other\\\\nschema_id: SCH_20251226180633\\\\nphysical: PROFILE_TABLE\\\\nobject_type: procedure\\\\ncomment:\\\\n---\\\\n\\\\n# SQL\\\\n```sql\\\\nCREATE OR REPLACE PROCEDURE DB_DESIGN.PROFILE_TABLE(\\\\n    P_TARGET_DB     STRING,\\\\n    P_TARGET_SCHEMA STRING,\\\\n    P_TARGET_TABLE  STRING,\\\\n    P_SAMPLE_PCT    FLOAT DEFAULT NULL,\\\\n    P_RUN_ID        STRING DEFAULT NULL,\\\\n    P_GIT_COMMIT    STRING DEFAULT NULL,\\\\n    P_NOTE          STRING DEFAULT NULL\\\\n)\\\\nRETURNS STRING\\\\nLANGUAGE SQL\\\\nEXECUTE AS OWNER\\\\nAS\\\\n$$\\\\nDECLARE\\\\n  V_RUN_ID    STRING;\\\\n  V_STARTED   TIMESTAMP_LTZ;\\\\n\\\\n  V_QDB   STRING;\\\\n  V_QSC   STRING;\\\\n  V_QTB   STRING;\\\\n  V_FULL  STRING;\\\\n\\\\n  V_COL_RS   RESULTSET;\\\\n  V_COL_NAME STRING;\\\\n\\\\n  V_QCOL    STRING;\\\\n  V_SQL     STRING;\\\\n  V_METRICS VARIANT;\\\\n  V_SQLC    STRING;\\\\nBEGIN\\\\n  /* ========== RUN 初期化 ========== */\\\\n  V_STARTED := CURRENT_TIMESTAMP();\\\\n  V_RUN_ID  := COALESCE(P_RUN_ID, 'RUN-' || UUID_STRING());\\\\n\\\\n  /* ========== RUN 登録（冪等） ========== */\\\\n  MERGE INTO DB_DESIGN.PROFILE_RUNS T\\\\n  USING (\\\\n    SELECT\\\\n      :V_RUN_ID        AS RUN_ID,\\\\n      :P_TARGET_DB     AS TARGET_DB,\\\\n      :P_TARGET_SCHEMA AS TARGET_SCHEMA,\\\\n      :P_TARGET_TABLE  AS TARGET_TABLE,\\\\n      :P_SAMPLE_PCT    AS SAMPLE_PCT,\\\\n      :V_STARTED       AS STARTED_AT,\\\\n      'RUNNING'        AS STATUS,\\\\n      CURRENT_WAREHOUSE() AS WAREHOUSE_NAME,\\\\n      CURRENT_ROLE()      AS ROLE_NAME,\\\\n      :P_GIT_COMMIT    AS GIT_COMMIT,\\\\n      :P_NOTE          AS NOTE\\\\n  ) S\\\\n  ON T.RUN_ID = S.RUN_ID\\\\n  WHEN MATCHED THEN\\\\n    UPDATE SET\\\\n      STARTED_AT     = S.STARTED_AT,\\\\n      FINISHED_AT    = NULL,\\\\n      STATUS         = 'RUNNING',\\\\n      SAMPLE_PCT     = S.SAMPLE_PCT,\\\\n      WAREHOUSE_NAME = S.WAREHOUSE_NAME,\\\\n      ROLE_NAME      = S.ROLE_NAME,\\\\n      GIT_COMMIT     = S.GIT_COMMIT,\\\\n      NOTE           = S.NOTE\\\\n  WHEN NOT MATCHED THEN\\\\n    INSERT (\\\\n      RUN_ID, TARGET_DB, TARGET_SCHEMA, TARGET_TABLE,\\\\n      SAMPLE_PCT, STARTED_AT, STATUS,\\\\n      WAREHOUSE_NAME, ROLE_NAME, GIT_COMMIT, NOTE\\\\n    )\\\\n    VALUES (\\\\n      S.RUN_ID, S.TARGET_DB, S.TARGET_SCHEMA, S.TARGET_TABLE,\\\\n      S.SAMPLE_PCT, S.STARTED_AT, S.STATUS,\\\\n      S.WAREHOUSE_NAME, S.ROLE_NAME, S.GIT_COMMIT, S.NOTE\\\\n    );\\\\n\\\\n  /* ========== 再実行対策：既存結果削除 ========== */\\\\n  DELETE FROM DB_DESIGN.PROFILE_RESULTS\\\\n   WHERE RUN_ID = :V_RUN_ID;\\\\n\\\\n  /* ========== 対象テーブル（フル修飾） ========== */\\\\n  V_QDB  := '\\\\\\"' || REPLACE(P_TARGET_DB, '\\\\\\"', '\\\\\\"\\\\\\"') || '\\\\\\"';\\\\n  V_QSC  := '\\\\\\"' || REPLACE(P_TARGET_SCHEMA, '\\\\\\"', '\\\\\\"\\\\\\"') || '\\\\\\"';\\\\n  V_QTB  := '\\\\\\"' || REPLACE(P_TARGET_TABLE, '\\\\\\"', '\\\\\\"\\\\\\"') || '\\\\\\"';\\\\n  V_FULL := V_QDB || '.' || V_QSC || '.' || V_QTB;\\\\n\\\\n  /* ========== 列一覧取得 ========== */\\\\n  V_SQLC := '\\\\n    SELECT COLUMN_NAME\\\\n    FROM ' || V_QDB || '.INFORMATION_SCHEMA.COLUMNS\\\\n    WHERE TABLE_SCHEMA = ?\\\\n      AND TABLE_NAME   = ?\\\\n    ORDER BY ORDINAL_POSITION\\\\n  ';\\\\n  V_COL_RS := (EXECUTE IMMEDIATE :V_SQLC USING (P_TARGET_SCHEMA, P_TARGET_TABLE));\\\\n\\\\n  /* ========== 列ごとのメトリクス算出 ========== */\\\\n  FOR REC IN V_COL_RS DO\\\\n    V_COL_NAME := REC.COLUMN_NAME;\\\\n    V_QCOL := '\\\\\\"' || REPLACE(V_COL_NAME, '\\\\\\"', '\\\\\\"\\\\\\"') || '\\\\\\"';\\\\n\\\\n    V_SQL := '\\\\nWITH SRC AS (\\\\n  SELECT * FROM ' || V_FULL ||\\\\n  CASE\\\\n    WHEN P_SAMPLE_PCT IS NULL THEN ''\\\\n    ELSE ' TABLESAMPLE BERNOULLI(' || P_SAMPLE_PCT || ')'\\\\n  END || '\\\\n),\\\\nAGG AS (\\\\n  SELECT\\\\n    COUNT(*) AS row_count,\\\\n    SUM(IFF(' || V_QCOL || ' IS NULL, 1, 0)) AS null_count,\\\\n    COUNT(DISTINCT ' || V_QCOL || ') AS distinct_count,\\\\n    MIN(TO_VARCHAR(' || V_QCOL || ')) AS min_varchar,\\\\n    MAX(TO_VARCHAR(' || V_QCOL || ')) AS max_varchar,\\\\n    MIN(LENGTH(TO_VARCHAR(' || V_QCOL || '))) AS min_len,\\\\n    MAX(LENGTH(TO_VARCHAR(' || V_QCOL || '))) AS max_len\\\\n  FROM SRC\\\\n),\\\\nTOP_VALUES AS (\\\\n  SELECT\\\\n    TO_VARCHAR(' || V_QCOL || ') AS v,\\\\n    COUNT(*) AS c\\\\n  FROM SRC\\\\n  WHERE ' || V_QCOL || ' IS NOT NULL\\\\n  GROUP BY 1\\\\n  ORDER BY c DESC\\\\n  LIMIT 20\\\\n)\\\\nSELECT OBJECT_CONSTRUCT(\\\\n  ''row_count'', row_count,\\\\n  ''null_count'', null_count,\\\\n  ''null_rate'', IFF(row_count=0, NULL, null_count::FLOAT/row_count),\\\\n  ''distinct_count'', distinct_count,\\\\n  ''distinct_rate_non_null'', IFF((row_count-null_count)=0, NULL, distinct_count::FLOAT/(row_count-null_count)),\\\\n  ''min_varchar'', min_varchar,\\\\n  ''max_varchar'', max_varchar,\\\\n  ''min_len'', min_len,\\\\n  ''max_len'', max_len,\\\\n  ''top_values'', (SELECT ARRAY_AGG(OBJECT_CONSTRUCT(''value'', v, ''count'', c)) FROM TOP_VALUES)\\\\n) AS METRICS\\\\nFROM AGG\\\\n';\\\\n\\\\n    EXECUTE IMMEDIATE :V_SQL;\\\\n\\\\n    SELECT METRICS\\\\n      INTO :V_METRICS\\\\n      FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()));\\\\n\\\\n    INSERT INTO DB_DESIGN.PROFILE_RESULTS\\\\n      (RUN_ID, TARGET_DB, TARGET_SCHEMA, TARGET_TABLE,\\\\n       TARGET_COLUMN, AS_OF_AT, METRICS)\\\\n    SELECT\\\\n      :V_RUN_ID, :P_TARGET_DB, :P_TARGET_SCHEMA, :P_TARGET_TABLE,\\\\n      :V_COL_NAME, CURRENT_TIMESTAMP(), :V_METRICS;\\\\n  END FOR;\\\\n\\\\n  /* ========== RUN 正常終了 ========== */\\\\n  UPDATE DB_DESIGN.PROFILE_RUNS\\\\n     SET FINISHED_AT = CURRENT_TIMESTAMP(),\\\\n         STATUS      = 'SUCCEEDED'\\\\n   WHERE RUN_ID = :V_RUN_ID;\\\\n\\\\n  RETURN V_RUN_ID;\\\\n\\\\nEXCEPTION\\\\n  WHEN OTHER THEN\\\\n    UPDATE DB_DESIGN.PROFILE_RUNS\\\\n       SET FINISHED_AT = CURRENT_TIMESTAMP(),\\\\n           STATUS      = 'FAILED',\\\\n           NOTE =\\\\n             COALESCE(:P_NOTE, '') ||\\\\n             IFF(:P_NOTE IS NULL, '', ' | ') ||\\\\n             'ERROR(' || :SQLCODE || '): ' || :SQLERRM\\\\n     WHERE RUN_ID = :V_RUN_ID;\\\\n    RAISE;\\\\nEND;\\\\n$$;\\\\n```\\\\n\\\\n\\"},{\\"count\\":1,\\"value\\":\\"---\\\\ntype: other\\\\nschema_id: SCH_20251226180633\\\\nphysical: INGEST_VAULT_MD\\\\nobject_type: procedure\\\\ncomment:\\\\n---\\\\n\\\\n# SQL\\\\n```sql\\\\nCREATE OR REPLACE PROCEDURE DB_DESIGN.INGEST_VAULT_MD(\\\\\\"STAGE_NAME\\\\\\" VARCHAR, \\\\\\"PATTERN\\\\\\" VARCHAR)\\\\nRETURNS VARIANT\\\\nLANGUAGE PYTHON\\\\nRUNTIME_VERSION = '3.11'\\\\nPACKAGES = ('snowflake-snowpark-python')\\\\nHANDLER = 'run'\\\\nEXECUTE AS OWNER\\\\nAS '\\\\nimport hashlib\\\\nfrom snowflake.snowpark.files import SnowflakeFile\\\\n\\\\nBUCKET = \\\\\\"135365622922-snowflake-dbdesign\\\\\\"\\\\n\\\\ndef _md5(s: str) -> str:\\\\n    return hashlib.md5(s.encode(\\\\\\"utf-8\\\\\\")).hexdigest()\\\\n\\\\ndef _to_relpath(name: str) -> str:\\\\n    \\\\\\"\\\\\\"\\\\\\"\\\\n    LIST結果のnameが\\\\n      - s3://<bucket>/path...\\\\n      - path...\\\\n    のどちらでも、ステージ相対パスを返す。\\\\n    \\\\\\"\\\\\\"\\\\\\"\\\\n    n = str(name).lstrip(\\\\\\"/\\\\\\")\\\\n    prefix = f\\\\\\"s3://{BUCKET}/\\\\\\"\\\\n    if n.startswith(prefix):\\\\n        return n[len(prefix):]\\\\n    # 念のため一般形（s3://bucket/...）も扱う\\\\n    if n.startswith(\\\\\\"s3://\\\\\\"):\\\\n        parts = n.split(\\\\\\"/\\\\\\", 3)\\\\n        # [''s3:'', '''', ''<bucket>'', ''<rest>'']\\\\n        return parts[3] if len(parts) >= 4 else \\\\\\"\\\\\\"\\\\n    return n\\\\n\\\\ndef run(session, stage_name, pattern):\\\\n    rows = session.sql(f\\\\\\"LIST {stage_name} PATTERN=''{pattern}''\\\\\\").collect()\\\\n\\\\n    processed = 0\\\\n    errors = 0\\\\n    samples = []\\\\n\\\\n    for r in rows:\\\\n        try:\\\\n            d = r.as_dict()\\\\n            full_name = d[\\\\\\"name\\\\\\"]\\\\n            last_modified = d.get(\\\\\\"last_modified\\\\\\", None)\\\\n\\\\n            relpath = _to_relpath(full_name)\\\\n            if not relpath:\\\\n                raise Exception(f\\\\\\"Could not derive relpath from name={full_name}\\\\\\")\\\\n\\\\n            # scoped url: 第2引数はステージ相対パス\\\\n            safe_rel = relpath.replace(\\\\\\"''\\\\\\", \\\\\\"''''\\\\\\")\\\\n            scoped_url = session.sql(\\\\n                f\\\\\\"SELECT BUILD_SCOPED_FILE_URL({stage_name}, ''{safe_rel}'') AS U\\\\\\"\\\\n            ).collect()[0][\\\\\\"U\\\\\\"]\\\\n\\\\n            with SnowflakeFile.open(scoped_url, \\\\\\"rb\\\\\\") as f:\\\\n                content = f.read().decode(\\\\\\"utf-8\\\\\\", errors=\\\\\\"replace\\\\\\")\\\\n\\\\n            folder = relpath.split(\\\\\\"/\\\\\\", 1)[0] if \\\\\\"/\\\\\\" in relpath else relpath\\\\n            doc_id = _md5(relpath)\\\\n\\\\n            session.sql(\\\\n                \\\\\\"\\\\\\"\\\\\\"\\\\nMERGE INTO DB_DESIGN.DOCS_OBSIDIAN t\\\\nUSING (\\\\n  SELECT\\\\n    ? AS DOC_ID,\\\\n    ? AS PATH,\\\\n    ? AS FOLDER,\\\\n    ? AS CONTENT,\\\\n    TRY_TO_TIMESTAMP_TZ(?)::TIMESTAMP_LTZ AS FILE_LAST_MODIFIED\\\\n) s\\\\nON t.DOC_ID = s.DOC_ID\\\\nWHEN MATCHED AND (\\\\n     t.FILE_LAST_MODIFIED IS NULL\\\\n  OR s.FILE_LAST_MODIFIED IS NULL\\\\n  OR s.FILE_LAST_MODIFIED > t.FILE_LAST_MODIFIED\\\\n)\\\\nTHEN UPDATE SET\\\\n  PATH = s.PATH,\\\\n  FOLDER = s.FOLDER,\\\\n  CONTENT = s.CONTENT,\\\\n  FILE_LAST_MODIFIED = s.FILE_LAST_MODIFIED,\\\\n  INGESTED_AT = CURRENT_TIMESTAMP()\\\\nWHEN NOT MATCHED THEN\\\\n  INSERT (DOC_ID, PATH, FOLDER, CONTENT, FILE_LAST_MODIFIED)\\\\n  VALUES (s.DOC_ID, s.PATH, s.FOLDER, s.CONTENT, s.FILE_LAST_MODIFIED)\\\\n                \\\\\\"\\\\\\"\\\\\\",\\\\n                params=[doc_id, relpath, folder, content, last_modified]\\\\n            ).collect()\\\\n\\\\n            processed += 1\\\\n\\\\n        except Exception as e:\\\\n            errors += 1\\\\n            if len(samples) < 5:\\\\n                samples.append({\\\\\\"error\\\\\\": str(e), \\\\\\"name\\\\\\": d.get(\\\\\\"name\\\\\\")})\\\\n\\\\n    return {\\\\\\"files_listed\\\\\\": len(rows), \\\\\\"processed\\\\\\": processed, \\\\\\"errors\\\\\\": errors, \\\\\\"samples\\\\\\": samples}\\\\n';\\\\n```\\\\n\\"},{\\"count\\":1,\\"value\\":\\"\\\\n```yaml\\\\nname: SV_SALES\\\\ndescription: らくらく案件データ（正規化VIEW群）を元にした売上・請求分析向けセマンティックモデル\\\\n\\\\ntables:\\\\n  - name: DEPARTMENTS\\\\n    description: 部署マスタ（年度別）\\\\n    base_table:\\\\n      database: GBPS253YS_DB\\\\n      schema: APP_PRODUCTION\\\\n      table: DEPARTMENT_MASTER\\\\n    primary_key:\\\\n      columns: [FISCAL_YEAR, DEPARTMENT_ID]\\\\n    dimensions:\\\\n      - name: DEPARTMENT_CODE\\\\n        expr: DEPARTMENT_CODE\\\\n        data_type: TEXT\\\\n        description: 部CD（部の配下をまとめるキー）。1桁の文字列。\\\\n        synonyms: [\\\\\\"部CD\\\\\\", \\\\\\"部コード\\\\\\", \\\\\\"部\\\\\\", \\\\\\"department_code\\\\\\"]\\\\n      - name: SECTION_CODE\\\\n        expr: SECTION_CODE\\\\n        data_type: TEXT\\\\n        description: 課CD。1桁の文字列。\\\\n        synonyms: [\\\\\\"課CD\\\\\\", \\\\\\"課コード\\\\\\", \\\\\\"課\\\\\\", \\\\\\"section_code\\\\\\"]\\\\n      - name: GROUP_CODE\\\\n        expr: GROUP_CODE\\\\n        data_type: TEXT\\\\n        description: グループCD。1桁の文字列。\\\\n        synonyms: [\\\\\\"グループCD\\\\\\", \\\\\\"グループコード\\\\\\", \\\\\\"グループ\\\\\\", \\\\\\"group_code\\\\\\"]\\\\n      - name: FISCAL_YEAR\\\\n        expr: FISCAL_YEAR\\\\n        data_type: TEXT\\\\n        description: 年度\\\\n      - name: DEPARTMENT_ID\\\\n        expr: DEPARTMENT_ID\\\\n        data_type: TEXT\\\\n        description: 部署ID\\\\n\\\\n  - name: CUSTOMERS\\\\n    description: 取引先マスタ（正規化VIEW）\\\\n    base_table:\\\\n      database: GBPS253YS_DB\\\\n      schema: APP_PRODUCTION\\\\n      table: V_CUSTOMER_MASTER\\\\n    primary_key:\\\\n      columns: [CUSTOMER_ID]\\\\n    dimensions:\\\\n      - name: CUSTOMER_ID\\\\n        expr: CUSTOMER_ID\\\\n        data_type: TEXT\\\\n        description: 取引先ID\\\\n        synonyms: [\\\\\\"顧客ID\\\\\\", \\\\\\"取引先コード\\\\\\"]\\\\n      - name: CUSTOMER_NAME\\\\n        expr: CUSTOMER_NAME\\\\n        data_type: TEXT\\\\n        description: 取引先名\\\\n        synonyms: [\\\\\\"顧客名\\\\\\", \\\\\\"取引先名\\\\\\"]\\\\n      - name: ACTIVE_FLAG\\\\n        expr: ACTIVE_FLAG\\\\n        data_type: TEXT\\\\n        description: 有効無効フラグ\\\\n\\\\n  - name: PROJECTS\\\\n    description: 案件マスタ（案件番号＋枝番＋年度）\\\\n    base_table:\\\\n      database: GBPS253YS_DB\\\\n      schema: APP_PRODUCTION\\\\n      table: V_PROJECT_MASTER\\\\n    primary_key:\\\\n      columns: [PROJECT_NUMBER, BRANCH_NUMBER, FISCAL_YEAR]\\\\n    dimensions:\\\\n      - name: PROJECT_NUMBER\\\\n        expr: PROJECT_NUMBER\\\\n        data_type: TEXT\\\\n        description: 案件番号\\\\n      - name: BRANCH_NUMBER\\\\n        expr: BRANCH_NUMBER\\\\n        data_type: TEXT\\\\n        description: 枝番\\\\n      - name: FISCAL_YEAR\\\\n        expr: FISCAL_YEAR\\\\n        data_type: TEXT\\\\n        description: 年度\\\\n      - name: PROJECT_NAME\\\\n        expr: PROJECT_NAME\\\\n        data_type: TEXT\\\\n        description: 案件名\\\\n        synonyms: [\\\\\\"案件\\\\\\"]\\\\n      - name: SUBJECT\\\\n        expr: SUBJECT\\\\n        data_type: TEXT\\\\n        description: 件名\\\\n      - name: SALES_CATEGORY\\\\n        expr: SALES_CATEGORY\\\\n        data_type: TEXT\\\\n        description: 売上区分\\\\n      - name: RANK\\\\n        expr: RANK\\\\n        data_type: TEXT\\\\n        description: 案件ランク\\\\n        synonyms: [\\\\\\"ランク\\\\\\", \\\\\\"確度\\\\\\", \\\\\\"ステータス\\\\\\", \\\\\\"確定ランク\\\\\\", \\\\\\"確定済\\\\\\"]\\\\n      - name: CUSTOMER_ID\\\\n        expr: CUSTOMER_ID\\\\n        data_type: TEXT\\\\n        description: 取引先ID\\\\n      - name: DEPARTMENT_ID\\\\n        expr: DEPARTMENT_ID\\\\n        data_type: TEXT\\\\n        description: 部署ID\\\\n      - name: WORK_START_DATE\\\\n        expr: WORK_START_DATE\\\\n        data_type: DATE\\\\n        description: 作業開始日\\\\n      - name: WORK_END_DATE\\\\n        expr: WORK_END_DATE\\\\n        data_type: DATE\\\\n        description: 作業終了日\\\\n      - name: IS_CONFIRMED\\\\n        expr: CASE WHEN RANK = '確定' THEN 'Y' ELSE 'N' END\\\\n        data_type: TEXT\\\\n        description: 確定ランク判定\\\\n        synonyms: [\\\\\\"確定\\\\\\", \\\\\\"確定済\\\\\\", \\\\\\"確定ランク\\\\\\"]\\\\n\\\\n  - name: ORDERS\\\\n    description: オーダマスタ（オーダ番号）\\\\n    base_table:\\\\n      database: GBPS253YS_DB\\\\n      schema: APP_PRODUCTION\\\\n      table: V_ORDER_MASTER\\\\n    primary_key:\\\\n      columns: [ORDER_NUMBER]\\\\n    dimensions:\\\\n      - name: ORDER_NUMBER\\\\n        expr: ORDER_NUMBER\\\\n        data_type: TEXT\\\\n        description: オーダ番号\\\\n        synonyms: [\\\\\\"受注番号\\\\\\", \\\\\\"オーダ\\\\\\"]\\\\n      - name: ORDER_NAME\\\\n        expr: ORDER_NAME\\\\n        data_type: TEXT\\\\n        description: オーダ名\\\\n      - name: CUSTOMER_ORDER_NUMBER\\\\n        expr: CUSTOMER_ORDER_NUMBER\\\\n        data_type: TEXT\\\\n        description: 顧客注文番号\\\\n        synonyms: [\\\\\\"PO番号\\\\\\"]\\\\n      - name: PROJECT_NUMBER\\\\n        expr: PROJECT_NUMBER\\\\n        data_type: TEXT\\\\n        description: 案件番号\\\\n      - name: BRANCH_NUMBER\\\\n        expr: BRANCH_NUMBER\\\\n        data_type: TEXT\\\\n        description: 枝番\\\\n      - name: FISCAL_YEAR\\\\n        expr: FISCAL_YEAR\\\\n        data_type: TEXT\\\\n        description: 年度\\\\n\\\\n  - name: INVOICES\\\\n    description: 請求（請求番号×計上月、金額は集計済）\\\\n    base_table:\\\\n      database: GBPS253YS_DB\\\\n      schema: APP_PRODUCTION\\\\n      table: V_INVOICE\\\\n    primary_key:\\\\n      columns: [INVOICE_KEY, ACCOUNTING_MONTH]\\\\n    dimensions:\\\\n      - name: INVOICE_KEY\\\\n        expr: INVOICE_KEY\\\\n        data_type: TEXT\\\\n        description: 請求キー（請求番号 or 仮キー）\\\\n      - name: ACCOUNTING_DATE\\\\n        expr: TO_DATE(ACCOUNTING_MONTH || '/01', 'YYYY/MM/DD')\\\\n        data_type: DATE\\\\n        description: 計上月（ACCOUNTING_MONTH を月初日の DATE に変換）\\\\n        synonyms: [\\\\\\"計上日\\\\\\", \\\\\\"計上月\\\\\\", \\\\\\"売上月\\\\\\", \\\\\\"月\\\\\\", \\\\\\"month\\\\\\"]\\\\n      - name: ACCOUNTING_MONTH\\\\n        expr: ACCOUNTING_MONTH\\\\n        data_type: TEXT\\\\n        description: 計上月（YYYY/MM 形式・表示用）\\\\n        synonyms: [\\\\\\"計上月文字列\\\\\\"]\\\\n      - name: ORDER_NUMBER\\\\n        expr: ORDER_NUMBER\\\\n        data_type: TEXT\\\\n        description: オーダ番号\\\\n      - name: SALES_DELIVERY_FLAG\\\\n        expr: SALES_DELIVERY_FLAG\\\\n        data_type: TEXT\\\\n        description: 売上渡しフラグ\\\\n    facts:\\\\n      - name: AMOUNT\\\\n        expr: AMOUNT\\\\n        data_type: NUMBER\\\\n        description: 請求金額（集計済）\\\\n    metrics:\\\\n      - name: TOTAL_SALES\\\\n        expr: SUM(AMOUNT)\\\\n        description: 売上合計（請求金額合計）\\\\n        synonyms: [\\\\\\"売上\\\\\\", \\\\\\"請求合計\\\\\\"]\\\\n      - name: INVOICE_COUNT\\\\n        expr: COUNT(DISTINCT CONCAT(INVOICE_NUMBER, '-', ACCOUNTING_MONTH))\\\\n        description: 請求件数（請求×計上月）\\\\n\\\\nrelationships:\\\\n  - name: PROJECTS_TO_CUSTOMERS\\\\n    left_table: PROJECTS\\\\n    right_table: CUSTOMERS\\\\n    join_type: left_outer\\\\n    relationship_type: many_to_one\\\\n    relationship_columns:\\\\n      - left_column: CUSTOMER_ID\\\\n        right_column: CUSTOMER_ID\\\\n\\\\n  - name: ORDERS_TO_PROJECTS\\\\n    left_table: ORDERS\\\\n    right_table: PROJECTS\\\\n    join_type: left_outer\\\\n    relationship_type: many_to_one\\\\n    relationship_columns:\\\\n      - left_column: PROJECT_NUMBER\\\\n        right_column: PROJECT_NUMBER\\\\n      - left_column: BRANCH_NUMBER\\\\n        right_column: BRANCH_NUMBER\\\\n      - left_column: FISCAL_YEAR\\\\n        right_column: FISCAL_YEAR\\\\n\\\\n  - name: INVOICES_TO_ORDERS\\\\n    left_table: INVOICES\\\\n    right_table: ORDERS\\\\n    join_type: left_outer\\\\n    relationship_type: many_to_one\\\\n    relationship_columns:\\\\n      - left_column: ORDER_NUMBER\\\\n        right_column: ORDER_NUMBER\\\\n        \\\\n  - name: PROJECTS_TO_DEPARTMENTS\\\\n    left_table: PROJECTS\\\\n    right_table: DEPARTMENTS\\\\n    join_type: left_outer\\\\n    relationship_type: many_to_one\\\\n    relationship_columns:\\\\n      - left_column: FISCAL_YEAR\\\\n        right_column: FISCAL_YEAR\\\\n      - left_column: DEPARTMENT_ID\\\\n        right_column: DEPARTMENT_ID\\\\n```\\\\n\\"}]}"},{"count":1,"value":"{\\"distinct_count\\":23,\\"distinct_rate_non_null\\":4.791666666666667e-01,\\"max_len\\":10,\\"max_varchar\\":\\"2027/03/31\\",\\"min_len\\":10,\\"min_varchar\\":\\"2025/07/31\\",\\"null_count\\":61,\\"null_rate\\":5.596330275229358e-01,\\"row_count\\":109,\\"top_values\\":[{\\"count\\":10,\\"value\\":\\"2026/03/31\\"},{\\"count\\":5,\\"value\\":\\"2025/09/30\\"},{\\"count\\":4,\\"value\\":\\"2025/07/31\\"},{\\"count\\":3,\\"value\\":\\"2026/03/10\\"},{\\"count\\":2,\\"value\\":\\"2026/06/30\\"},{\\"count\\":2,\\"value\\":\\"2026/03/27\\"},{\\"count\\":2,\\"value\\":\\"2025/10/31\\"},{\\"count\\":2,\\"value\\":\\"2025/12/24\\"},{\\"count\\":2,\\"value\\":\\"2025/09/26\\"},{\\"count\\":2,\\"value\\":\\"2026/02/24\\"},{\\"count\\":2,\\"value\\":\\"2026/03/23\\"},{\\"count\\":1,\\"value\\":\\"2025/12/19\\"},{\\"count\\":1,\\"value\\":\\"2026/01/30\\"},{\\"count\\":1,\\"value\\":\\"2026/03/26\\"},{\\"count\\":1,\\"value\\":\\"2026/03/20\\"},{\\"count\\":1,\\"value\\":\\"2026/02/23\\"},{\\"count\\":1,\\"value\\":\\"2025/08/20\\"},{\\"count\\":1,\\"value\\":\\"2026/03/19\\"},{\\"count\\":1,\\"value\\":\\"2027/03/31\\"},{\\"count\\":1,\\"value\\":\\"2026/02/20\\"}]}"},{"count":1,"value":"{\\"distinct_count\\":12,\\"distinct_rate_non_null\\":1.000000000000000e+00,\\"max_len\\":5,\\"max_varchar\\":\\"00110\\",\\"min_len\\":5,\\"min_varchar\\":\\"00007\\",\\"null_count\\":0,\\"null_rate\\":0.000000000000000e+00,\\"row_count\\":12,\\"top_values\\":[{\\"count\\":1,\\"value\\":\\"00071\\"},{\\"count\\":1,\\"value\\":\\"00007\\"},{\\"count\\":1,\\"value\\":\\"00052\\"},{\\"count\\":1,\\"value\\":\\"00053\\"},{\\"count\\":1,\\"value\\":\\"00014\\"},{\\"count\\":1,\\"value\\":\\"00055\\"},{\\"count\\":1,\\"value\\":\\"00095\\"},{\\"count\\":1,\\"value\\":\\"00102\\"},{\\"count\\":1,\\"value\\":\\"00031\\"},{\\"count\\":1,\\"value\\":\\"00036\\"},{\\"count\\":1,\\"value\\":\\"00110\\"},{\\"count\\":1,\\"value\\":\\"00072\\"}]}"},{"count":1,"value":"{\\"distinct_count\\":60,\\"distinct_rate_non_null\\":8.571428571428571e-01,\\"max_len\\":38,\\"max_varchar\\":\\"ＮＸ商事（本稼働支援）\\",\\"min_len\\":2,\\"min_varchar\\":\\"Azure利用料(VSQ)・cloudThrow保守(VSQ)\\",\\"null_count\\":35,\\"null_rate\\":3.333333333333333e-01,\\"row_count\\":105,\\"top_values\\":[{\\"count\\":3,\\"value\\":\\"クラウド利用料(AWS)\\"},{\\"count\\":3,\\"value\\":\\"インフラ運用(麻生レコードマネジメント)\\"},{\\"count\\":3,\\"value\\":\\"芳賀\\"},{\\"count\\":3,\\"value\\":\\"岩瀬・行實(BP)_2025\\"},{\\"count\\":2,\\"value\\":\\"北島_202507-09\\"},{\\"count\\":2,\\"value\\":\\"クラウド利用料(AIA・SEQC)\\"},{\\"count\\":1,\\"value\\":\\"Honda社Tagetik導入案件（202508-09）\\"},{\\"count\\":1,\\"value\\":\\"熊本国保連／Office2024バージョンアップ対応\\"},{\\"count\\":1,\\"value\\":\\"マネーフォワードシステム導入対応（アステリア連携）_ＲＤ\\"},{\\"count\\":1,\\"value\\":\\"インフラサポート契約\\"},{\\"count\\":1,\\"value\\":\\"宮崎市_標準化対応Ｒ７（障がい者）\\"},{\\"count\\":1,\\"value\\":\\"株式管理システムバージョンアップ（20251001-1114）\\"},{\\"count\\":1,\\"value\\":\\"荒川区介護保守（R７）　下期\\"},{\\"count\\":1,\\"value\\":\\"人労一括_九メンデータ出力対応(2回目)(1月)\\"},{\\"count\\":1,\\"value\\":\\"JPRO 拡販作業（11月）\\"},{\\"count\\":1,\\"value\\":\\"Azure利用料(VSQ)・cloudThrow保守(VSQ)\\"},{\\"count\\":1,\\"value\\":\\"ハード制御仕様書の管理Tool開発（中村）（202504-09）\\"},{\\"count\\":1,\\"value\\":\\"ハード制御仕様書の管理Tool開発（吉見）（202510-12）\\"},{\\"count\\":1,\\"value\\":\\"ヤマエ_稼働後支援追加作業\\"},{\\"count\\":1,\\"value\\":\\"クラウド利用料(R&S)\\"}]}"},{"count":1,"value":"{\\"distinct_count\\":53,\\"distinct_rate_non_null\\":8.983050847457628e-01,\\"max_len\\":14,\\"max_varchar\\":\\"FJFGTQ00211236\\",\\"min_len\\":8,\\"min_varchar\\":\\"23010601\\",\\"null_count\\":89,\\"null_rate\\":6.013513513513513e-01,\\"row_count\\":148,\\"top_values\\":[{\\"count\\":2,\\"value\\":\\"FJFGTQ00141343\\"},{\\"count\\":2,\\"value\\":\\"25002296\\"},{\\"count\\":2,\\"value\\":\\"23010601\\"},{\\"count\\":2,\\"value\\":\\"24010968\\"},{\\"count\\":2,\\"value\\":\\"FJFGTQ00145829\\"},{\\"count\\":2,\\"value\\":\\"25004274\\"},{\\"count\\":1,\\"value\\":\\"25002921\\"},{\\"count\\":1,\\"value\\":\\"FHG500070000\\"},{\\"count\\":1,\\"value\\":\\"FJFGTQ00211236\\"},{\\"count\\":1,\\"value\\":\\"FJFGTQ00185607\\"},{\\"count\\":1,\\"value\\":\\"FJFGTQ00175399\\"},{\\"count\\":1,\\"value\\":\\"FJFGTQ00203034\\"},{\\"count\\":1,\\"value\\":\\"FJFGTQ00142145\\"},{\\"count\\":1,\\"value\\":\\"FJFGTQ00133826\\"},{\\"count\\":1,\\"value\\":\\"FJFGTQ00189119\\"},{\\"count\\":1,\\"value\\":\\"FJFGTQ00182322\\"},{\\"count\\":1,\\"value\\":\\"FJFGTQ00174280\\"},{\\"count\\":1,\\"value\\":\\"FJFGTQ00204246\\"},{\\"count\\":1,\\"value\\":\\"FJFGTQ00134540\\"},{\\"count\\":1,\\"value\\":\\"FJFGTQ00175312\\"}]}"},{"count":1,"value":"{\\"distinct_count\\":97,\\"distinct_rate_non_null\\":7.637795275590551e-01,\\"max_len\\":48,\\"max_varchar\\":\\"Ｓｏｌａｒｉｓ関連システム障害対応迅速化のための業務支援\\",\\"min_len\\":2,\\"min_varchar\\":\\"2025_統括部）協力会社育成(5月)\\",\\"null_count\\":0,\\"null_rate\\":0.000000000000000e+00,\\"row_count\\":127,\\"top_values\\":[{\\"count\\":6,\\"value\\":\\"Microsoft Azure クラウド利用料\\"},{\\"count\\":4,\\"value\\":\\"技術料\\"},{\\"count\\":3,\\"value\\":\\"FL.OPS利用料金\\"},{\\"count\\":3,\\"value\\":\\"クラウド利用料(AWS)\\"},{\\"count\\":3,\\"value\\":\\"情報処理システム開発(令4条1項1号)坂本分\\"},{\\"count\\":3,\\"value\\":\\"ニフクラ利用料金\\"},{\\"count\\":3,\\"value\\":\\"インフラ設計／構築／保守業務\\"},{\\"count\\":3,\\"value\\":\\"ニフクラウド利用料(正晃) SPDシステム\\"},{\\"count\\":3,\\"value\\":\\"インフラサポート（月額）\\"},{\\"count\\":2,\\"value\\":\\"Ｓｏｌａｒｉｓ関連システム障害対応迅速化のための業務支援\\"},{\\"count\\":2,\\"value\\":\\"人労シェアードシステム（問合せ対応）\\"},{\\"count\\":2,\\"value\\":\\"ハード制御仕様書の管理Tool開発（中村）（202510-202603）\\"},{\\"count\\":2,\\"value\\":\\"BiCS保守\\"},{\\"count\\":2,\\"value\\":\\"AWS案件(JTP様SES契約) ※ガバメントクラウド案件　石橋(BP)\\"},{\\"count\\":2,\\"value\\":\\"届出管理システム保守\\"},{\\"count\\":2,\\"value\\":\\"ストレスチェックシステム保守\\"},{\\"count\\":2,\\"value\\":\\"サーバ運用保守\\"},{\\"count\\":1,\\"value\\":\\"Honda社Tagetik導入案件（202601-03）\\"},{\\"count\\":1,\\"value\\":\\"中継設備管理システム保守\\"},{\\"count\\":1,\\"value\\":\\"【脱ホ配】配資経システム再構築のうち事前疎結合対応について（ＳＴＥＰ１）\\"}]}"}]},"run_id":"RUN-021612e8-9e32-41f8-af96-40191ccb8d48"},{"as_of_at":"2025-12-30 05:06:08.579 -0800","column":"TARGET_DB","metrics":{"distinct_count":1,"distinct_rate_non_null":7.142857142857142e-02,"max_len":12,"max_varchar":"GBPS253YS_DB","min_len":12,"min_varchar":"GBPS253YS_DB","null_count":0,"null_rate":0.000000000000000e+00,"row_count":14,"top_values":[{"count":14,"value":"GBPS253YS_DB"}]},"run_id":"RUN-021612e8-9e32-41f8-af96-40191ccb8d48"},{"as_of_at":"2025-12-30 05:06:09.745 -0800","column":"TARGET_SCHEMA","metrics":{"distinct_count":2,"distinct_rate_non_null":1.250000000000000e-01,"max_len":14,"max_varchar":"DB_DESIGN","min_len":9,"min_varchar":"APP_PRODUCTION","null_count":0,"null_rate":0.000000000000000e+00,"row_count":16,"top_values":[{"count":11,"value":"APP_PRODUCTION"},{"count":5,"value":"DB_DESIGN"}]},"run_id":"RUN-021612e8-9e32-41f8-af96-40191ccb8d48"},{"as_of_at":"2025-12-30 05:06:10.824 -0800","column":"TARGET_TABLE","metrics":{"distinct_count":5,"distinct_rate_non_null":4.545454545454545e-01,"max_len":17,"max_varchar":"PROFILE_RUNS","min_len":12,"min_varchar":"ANKEN_MEISAI","null_count":0,"null_rate":0.000000000000000e+00,"row_count":11,"top_values":[{"count":6,"value":"DEPARTMENT_MASTER"},{"count":2,"value":"ANKEN_MEISAI"},{"count":1,"value":"PROFILE_RUNS"},{"count":1,"value":"PROFILE_RESULTS"},{"count":1,"value":"DOCS_OBSIDIAN"}]},"run_id":"RUN-021612e8-9e32-41f8-af96-40191ccb8d48"}],"run_date":"20251229_140447305","target_db":"GBPS253YS_DB","target_schema":"DB_DESIGN","target_table":"PROFILE_RESULTS"}
